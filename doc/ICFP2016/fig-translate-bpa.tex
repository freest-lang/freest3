\begin{figure}[tp]
    \begin{align*}
      \toLHS (\skipk) & = \Return\ \varepsilon \\
      \toLHS (A) & = \Return\ A \\
      \toLHS (S_1; S_2) & = \Do
                              \begin{array}[t]{l}
                                E_1 \gets \toLHS (S_1) \\
                                E_2 \gets \toLHS (S_2) \\
                                \Return (E_1\fatsemi E_2)
                              \end{array}
      \\
      \toLHS (\star\{\overline{l_n:S_n}\}) &= \Do
                                                 \begin{array}[t]{l}
                                                   \dots \\
                                                   E_i \gets \toLHS (S_i) \\
                                                   \dots \\
                                                   \Return\ (\star l_1\fatsemi E_1 + \dots + \star l_n\fatsemi E_n)
                                                 \end{array}
      \\
      \toLHS (\mu x.S) &= \Do
                             \begin{array}[t]{l}
                               E \gets \toLHS (S) \\
                               \Out (x = E) \\
                               \Return\ x
                             \end{array}
      \\
      \toLHS (x) &= \Return\ x
      \\
      \toBPA{S} &= \Do
                   \begin{array}[t]{l}
                     E \gets \toLHS (S) \\
                     \Out (x_0 = E) \\
                     \Return\ x_0
                   \end{array}
    \end{align*}
    Here $\fatsemi$ is defined as a smart sequencing constructor.
    \begin{align*}
      E_1 \fatsemi E_2 &=
                         \begin{cases}
                           E_1 & E_2=\varepsilon \\
                           E_2 & E_1=\varepsilon \\
                           E_1;E_2 & \text{otherwise}
                         \end{cases}
    \end{align*}
    \caption{Translation of a session type to a BPA}
    \label{fig:session-to-bpa}
  \end{figure}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
